create database sub;

use sub;

CREATE TABLE Department (
    DeptID INT PRIMARY KEY,
    DeptName VARCHAR(50),
    Location VARCHAR(50)
);

INSERT INTO Department (DeptID, DeptName, Location) VALUES
(101, 'Human Resources', 'New York'),
(102, 'Finance', 'Chicago'),
(103, 'IT', 'San Francisco'),
(104, 'Marketing', 'Boston');


CREATE TABLE Employee (
    EmpID INT PRIMARY KEY,
    EmpName VARCHAR(50),
    Age INT,
    Salary DECIMAL(10,2),
    DeptID INT,
    JoinDate DATE,
    FOREIGN KEY (DeptID) REFERENCES Department(DeptID)
);

INSERT INTO Employee (EmpID, EmpName, Age, Salary, DeptID, JoinDate) VALUES
(1, 'John Doe', 29, 55000, 101, '2020-01-15'),
(2, 'Sarah Lee', 34, 68000, 102, '2019-09-30'),
(3, 'Mike Ross', 41, 82000, 103, '2018-03-12'),
(4, 'Emma Stone', 27, 48000, 104, '2021-07-22'),
(5, 'Kevin Hart', 31, 60000, 103, '2020-11-01'),
(6, 'Olivia King', 38, 75000, 102, '2017-05-10'),
(7, 'Liam Smith', 25, 45000, 101, '2022-02-14'),
(8, 'Ava Brown', 30, 70000, 104, '2020-08-05'),
(9, 'David Park', 44, 92000, 103, '2016-12-19'),
(10, 'Nora Green', 33, 65000, 101, '2021-04-03');


SELECT * FROM EMPLOYEE;
SELECT * FROM DEPARTMENT;

-- FIND THE AVERAGE SALARY OF EMPLOYEES
SELECT AVG(SALARY) FROM EMPLOYEE;
-- FIND EMPLOYEE RECORDS THOSE ARE SALARY IS MORETHAN AVERAGE SALARY
SELECT * FROM EMPLOYEE
WHERE SALARY > 66000;

SELECT * FROM EMPLOYEE
WHERE SALARY > (SELECT AVG(SALARY) FROM EMPLOYEE);

-- FIND MAX SALARY IN EMPLOYEE TABLE
SELECT MAX(SALARY) FROM EMPLOYEE;
-- FIND EMPLOYEE DETAILS WHO GETTING MAXIMUM SLARY
SELECT * FROM EMPLOYEE
WHERE SALARY = 92000;

SELECT * FROM EMPLOYEE
WHERE SALARY = (SELECT MAX(SALARY) FROM EMPLOYEE);

-- FIND EMPLOYEE DETAILS THOES ARE WORKING IN 'David Park'S DEPARTMENT
SELECT * FROM EMPLOYEE
WHERE DEPTID = (SELECT DEPTID FROM EMPLOYEE 
				WHERE EMPNAME = 'David Park'
);

SELECT * FROM EMPLOYEE
WHERE DEPTID = (SELECT DEPTID FROM EMPLOYEE 
				WHERE EMPNAME = 'David Park'
) AND EMPNAME <> 'David Park';

--  FINDOUT THE EMPLOYE DETAILS THOSE WERE WORKING IN 'NEWYORK'


-- FIND THE TOTAL SALARY OF 'New York' AND 'Chicago' AND SORT BY DESCENDING ORDER
SELECT DEPTID, SUM(SALARY) AS TOTAL_SALARY FROM EMPLOYEE
WHERE DEPTID IN (SELECT DEPTID FROM DEPARTMENT
				WHERE LOCATION IN ('New York', 'Chicago')
)
GROUP BY DEPTID
ORDER BY TOTAL_SALARY;

-- FIND EMPLOYE DETAILS THOES SALARY IS MORETHAN THE ANY EMPLOYEE SALARY 
-- IN 101 DEPARTMENT
SELECT SALARY FROM EMPLOYEE
WHERE DEPTID = 101;
SELECT * FROM EMPLOYEE
WHERE SALARY > ANY(SELECT SALARY FROM EMPLOYEE
					WHERE DEPTID = 101
);

-- FIND EMPLOYE DETAILS THOES SALARY IS MORETHAN THE ALL EMPLOYEE SALARY 
-- IN 101 DEPARTMENT
SELECT SALARY FROM EMPLOYEE
WHERE DEPTID = 101;
SELECT * FROM 0EMPLOYEE
WHERE SALARY > ALL(SELECT SALARY FROM EMPLOYEE
					WHERE DEPTID = 101
);
SELECT * FROM DEPARTMENT;


-- coorelated sub query

create database cosub;
USE cosub;

CREATE TABLE Employee1 (
    EmpID INT PRIMARY KEY,
    EmpName VARCHAR(50),
    Age INT,
    Salary DECIMAL(10,2),
    DeptID INT,
    MANAGERID INT,
    JoinDate DATE,
    FOREIGN KEY (DeptID) REFERENCES Department(DeptID)
);

INSERT INTO Employee1 (EmpID, EmpName, Age, Salary, DeptID, JoinDate, MANAGERID) VALUES
(1, 'John Doe', 29, 55000, 101, '2020-01-15',1),
(2, 'Sarah Lee', 34, 68000, 102, '2019-09-30',1),
(3, 'Mike Ross', 41, 82000, 103, '2018-03-12',1),
(4, 'Emma Stone', 27, 48000, 104, '2021-07-22',4),
(5, 'Kevin Hart', 31, 60000, 103, '2020-11-01',4),
(6, 'Olivia King', 38, 75000, 102, '2017-05-10',4),
(7, 'Liam Smith', 25, 45000, 101, '2022-02-14',4),
(8, 'Ava Brown', 30, 70000, 104, '2020-08-05',9),
(9, 'David Park', 44, 92000, 103, '2016-12-19',9),
(10, 'Nora Green', 33, 65000, 101, '2021-04-03',9);

-- RETURN EMPLOYEE DETAILS WHOES SALARY IS MORETHAN THEIR 
-- 			RESPECTIVE MANAGER SALARY
SELECT E1.EMPID, E1.EMPNAME, E1.SALARY ,E1.MANAGERID FROM EMPLOYEE1 E1
WHERE E1.SALARY > (SELECT E2.SALARY FROM EMPLOYEE1 E2
					WHERE E2.EMPID = E1.MANAGERID);
-- FIND EMPLOYEE DETAILS WHOES SALARY IS MORETHAN THE AVERAGE
-- 			SALARY OF THRIE DEPARTMENT
SELECT E1.EMPID, E1.EMPNAME, E1.SALARY ,E1.DEPTID FROM EMPLOYEE1 E1
WHERE E1.SALARY > (SELECT AVG(E2.SALARY) FROM EMPLOYEE1 E2
					WHERE E2.DEPTID = E1.DEPTID);

-- EMPLOYEES WHO EARN HIGHEST SALARY IN THEIR DEPARTMENT
SELECT E1.EMPID, E1.EMPNAME, E1.SALARY ,E1.DEPTID FROM EMPLOYEE1 E1
WHERE E1.SALARY = (SELECT MAX(E2.SALARY) FROM EMPLOYEE1 E2
					WHERE E2.DEPTID = E1.DEPTID);
-- EMPLOYESS WHO EARN LOWEST SALARY IN THEIR MANAGER
SELECT E1.EMPID, E1.EMPNAME, E1.SALARY ,E1.MANAGERID FROM EMPLOYEE1 E1
WHERE E1.SALARY = (SELECT MIN(E2.SALARY) FROM EMPLOYEE1 E2
					WHERE E2.MANAGERID = E1.MANAGERID);
SELECT * FROM EMPLOYEE1;